# Comprehensive Comparison: Four Approaches to Sandboxing Claude Code

## Overview Table

| Feature | **SafeClaude** | **Sculptor (Imbue)** | **ClaudeBox (RchGrav)** | **Dev Containers** |
|---------|----------------|----------------------|-------------------------|-------------------|
| **Primary Goal** | Ephemeral sandbox with GitHub security | Parallel agents with UI management | Persistent multi-project CLI | Official VS Code integration |
| **Platform** | Standalone Docker CLI | Desktop app (Electron) | Standalone Docker CLI | VS Code extension |
| **Setup Complexity** | Medium (manual GitHub config) | Low (desktop app install) | Low (uses host credentials) | Medium (VS Code required) |
| **Git Authentication** | Deploy key (per-repo) | SSH keys (likely mounted) | SSH keys (read-only mount) | SSH agent (automatic) |
| **Credential Scope** | Limited (deploy key only) | Full (assumed host keys) | Full (host SSH keys) | Full (SSH agent) |
| **Persistence** | None (ephemeral) | Per-agent (containers persist) | Full (per-project state) | Full (named volumes) |
| **Parallel Agents** | ‚ùå | ‚úÖ (core feature) | ‚ùå | ‚ùå |
| **UI/UX** | CLI only | Desktop GUI | CLI only | VS Code integration |
| **Network Isolation** | Optional (default: isolated) | Network enabled (for LLM) | Firewall + allowlists | Firewall (default-deny) |
| **GitHub Setup** | Required (deploy key + protection) | None | None | None |
| **Security Model** | Server-side enforcement | Container isolation + UI controls | Container isolation | Container + firewall |

---

## 1. **SafeClaude (This Project)** üîê

**Philosophy:** Maximum security through least-privilege credentials and server-side enforcement

### Git Authentication
- **Method:** SSH deploy key (per-repository)
- **Setup:** Generate key ‚Üí Add to GitHub ‚Üí Configure branch protection
- **Scope:** Single repository only
- **Permissions:** Can push to branches, BLOCKED from protected branches by GitHub

### Security Model
```
Credentials:   Limited deploy key (generated, isolated)
Enforcement:   GitHub server-side (cannot be bypassed)
Principle:     Least privilege
Trust Model:   Zero trust (even with container access)
```

### Pros
- ‚úÖ **Most secure** - deploy key has minimal permissions
- ‚úÖ **Server-side enforcement** - GitHub blocks protected branches
- ‚úÖ **Cannot be bypassed** - works even if Claude compromises container
- ‚úÖ **Credential isolation** - not your personal SSH keys
- ‚úÖ **Per-repo control** - each repo gets separate key
- ‚úÖ **Ephemeral** - clean slate every session
- ‚úÖ **Simple architecture** - no complex state management

### Cons
- ‚ö†Ô∏è **Manual setup** - requires GitHub configuration
- ‚ö†Ô∏è **Per-repo setup** - must configure each repository
- ‚ö†Ô∏è **No persistence** - state lost on exit
- ‚ö†Ô∏è **Branch protection required** - relies on GitHub setup
- ‚ö†Ô∏è **Network limitations** - must manually enable with `--network`

### Best For
- ‚ú® Untrusted/experimental code
- ‚ú® Maximum security requirements
- ‚ú® One-off sandboxed sessions
- ‚ú® Shared environments (team/CI)
- ‚ú® Compliance/audit scenarios

---

## 2. **Sculptor (Imbue)** üé®

**Philosophy:** Parallel agent workflows with UI management and isolated sandboxes

### Overview
- **Type:** Desktop application (Electron-based)
- **Released:** October 2025 (research preview/beta)
- **Developer:** Imbue (AI agent research company)
- **Website:** https://imbue.com/sculptor/
- **GitHub:** https://github.com/imbue-ai/sculptor

### Git Authentication
- **Method:** SSH keys (mounted into containers)
- **Setup:** Uses your existing SSH configuration
- **Scope:** All repositories you have access to
- **Permissions:** Same as your host account

### Security Model
```
Credentials:   Host SSH keys (mounted/copied)
Enforcement:   Container isolation + UI oversight
Principle:     Isolated parallel agents
Trust Model:   Trusted repos with container boundaries
```

### Architecture
- Each agent runs in its own Docker container
- Desktop GUI for managing multiple agents simultaneously
- **"Pairing Mode"** - bidirectional sync between agent and local IDE
- Agents work on separate git branches
- Built-in merge/discard controls in UI

### Unique Features
- ‚úÖ **Parallel agents** - run multiple Claude instances on different tasks
- ‚úÖ **Visual management** - see all agents, their status, and outputs
- ‚úÖ **Branch isolation** - each agent works on its own branch
- ‚úÖ **Pairing mode** - test agent changes locally before committing
- ‚úÖ **Inline steering** - use TODO/FIXME comments to guide agents
- ‚úÖ **Context compaction** - manages long conversations
- ‚úÖ **Auto-recovery** - agents retry on errors
- ‚úÖ **Custom devcontainer support** - bring your own Dockerfile

### Pros
- ‚úÖ **Best for parallel work** - multiple agents on different features simultaneously
- ‚úÖ **Visual oversight** - see what all agents are doing at once
- ‚úÖ **Branch-based workflow** - natural git workflow with agent branches
- ‚úÖ **User-friendly** - desktop app with polished UI
- ‚úÖ **Merge controls** - explicit approval before merging agent changes
- ‚úÖ **Reduces cognitive load** - offload multiple tasks to parallel agents
- ‚úÖ **IDE integration** - pairing mode syncs with your editor
- ‚úÖ **Safety by design** - each agent isolated in container

### Cons
- ‚ö†Ô∏è **Full git access** - agents can push to any branch they can access
- ‚ö†Ô∏è **No branch protection** - relies on container isolation only
- ‚ö†Ô∏è **SSH keys exposed** - containers have access to host credentials
- ‚ö†Ô∏è **Network required** - agents need internet for LLM API calls
- ‚ö†Ô∏è **Desktop app only** - not a CLI tool (macOS + Linux only currently)
- ‚ö†Ô∏è **Beta/preview** - relatively new, still in development
- ‚ö†Ô∏è **Container overhead** - running many parallel agents uses resources
- ‚ö†Ô∏è **Trust required** - assumes you're working on trusted codebases

### Best For
- ‚ú® Working on multiple features/bugs in parallel
- ‚ú® Teams wanting to maximize AI agent productivity
- ‚ú® Complex projects where parallel work accelerates development
- ‚ú® Users who prefer GUI over CLI
- ‚ú® Scenarios requiring visual oversight of multiple agents
- ‚ú® Workflows with frequent context switching

### Security Considerations
**From their documentation:**
> "Recommends using IDE 'untrusted mode', carefully managing secret exposure, being cautious about network access, avoiding embedding secrets in code/prompts"

Similar to other solutions, Sculptor **does not implement branch protection** - it relies entirely on:
1. Container isolation
2. User oversight via UI
3. Explicit merge approval workflow
4. Best practices around secret management

---

## 3. **ClaudeBox (RchGrav)** üõ†Ô∏è

**Philosophy:** Full-featured development environment with persistent state

### Git Authentication
- **Method:** SSH agent forwarding (mounts `~/.ssh` read-only)
- **Setup:** None (uses existing host SSH keys)
- **Scope:** All repositories you have access to
- **Permissions:** Same as your host account

### Security Model
```
Credentials:   Your SSH keys (read-only mount)
Enforcement:   Container isolation only
Principle:     Trust but isolate
Trust Model:   Trusts Claude within container boundaries
```

### Pros
- ‚úÖ **Zero setup** - works with existing credentials
- ‚úÖ **Multi-repo** - access all your repositories
- ‚úÖ **Persistent state** - project configs, history, auth
- ‚úÖ **Profile system** - pre-configured environments (Python, Rust, Go, etc.)
- ‚úÖ **Rich features** - tmux, firewall allowlists, slot management
- ‚úÖ **Sophisticated** - handles complex multi-project workflows
- ‚úÖ **Flexible** - admin mode for persistent changes

### Cons
- ‚ö†Ô∏è **Full access** - Claude has same git permissions as you
- ‚ö†Ô∏è **No branch protection** - can push to main if you can
- ‚ö†Ô∏è **Exposes SSH keys** - in container (read-only, but accessible)
- ‚ö†Ô∏è **Complex** - many features = more to learn
- ‚ö†Ô∏è **Persistence risk** - state survives between sessions
- ‚ö†Ô∏è **Trust required** - relies entirely on container isolation

### Best For
- ‚ú® Trusted projects
- ‚ú® Long-term development
- ‚ú® Multi-repository workflows
- ‚ú® Power users who want persistence
- ‚ú® Teams needing consistent environments

---

## 4. **Claude Code Dev Containers** üè¢

**Philosophy:** Official VS Code integration with opinionated security

### Git Authentication
- **Method:** SSH agent forwarding (automatic via VS Code)
- **Setup:** VS Code + Remote Containers extension
- **Scope:** All repositories accessible to your SSH agent
- **Permissions:** Same as your host account

### Security Model
```
Credentials:   SSH agent forwarded by VS Code
Enforcement:   Network firewall + container isolation
Principle:     Defense in depth
Trust Model:   Trusted repos + network restrictions
```

### Pros
- ‚úÖ **Official solution** - maintained by Anthropic
- ‚úÖ **Automatic auth** - SSH agent forwarding just works
- ‚úÖ **Network firewall** - default-deny with allowlists (GitHub, npm, Claude API)
- ‚úÖ **VS Code integration** - seamless IDE experience
- ‚úÖ **Persistent volumes** - command history, config preserved
- ‚úÖ **Reference implementation** - best practices from Anthropic
- ‚úÖ **Well-documented** - official docs and support

### Cons
- ‚ö†Ô∏è **VS Code required** - not standalone
- ‚ö†Ô∏è **Full git access** - can push to main
- ‚ö†Ô∏è **Warning in docs** - "do not prevent a malicious project from exfiltrating anything accessible"
- ‚ö†Ô∏è **Network complexity** - firewall rules to manage
- ‚ö†Ô∏è **Less flexible** - tied to VS Code workflow
- ‚ö†Ô∏è **Documentation caveat** - "only using devcontainers when developing with trusted repositories"

### Best For
- ‚ú® VS Code users
- ‚ú® Trusted repositories
- ‚ú® Official supported workflow
- ‚ú® Teams wanting standardized environments
- ‚ú® Network-restricted environments

---

## Security Comparison

### Attack Scenarios

| Scenario | SafeClaude | Sculptor | ClaudeBox | Dev Containers |
|----------|-----------|----------|-----------|----------------|
| **Claude tries to push to main** | ‚ùå Blocked by GitHub | ‚úÖ Succeeds | ‚úÖ Succeeds | ‚úÖ Succeeds |
| **Malicious code reads SSH keys** | ‚úÖ Safe (deploy key only) | ‚ö†Ô∏è Can access | ‚ö†Ô∏è Can read (read-only) | ‚ö†Ô∏è Can access via agent |
| **Code exfiltrates data** | ‚ö†Ô∏è If network enabled | ‚ö†Ô∏è Network required | ‚ö†Ô∏è Via allowlisted domains | ‚ö†Ô∏è Via allowlisted domains |
| **Container escapes** | ‚úÖ Safe (limited key) | ‚ö†Ô∏è Has your credentials | ‚ö†Ô∏è Has your credentials | ‚ö†Ô∏è Has SSH agent access |
| **Persists malware** | ‚úÖ Safe (ephemeral) | ‚ö†Ô∏è Possible (per-agent) | ‚ö†Ô∏è Possible (persistence) | ‚ö†Ô∏è Possible (volumes) |
| **Parallel agent conflicts** | N/A (single agent) | ‚úÖ Isolated by design | N/A (single agent) | N/A (single agent) |

### Security Levels

**Most Secure ‚Üí Least Secure:**
1. **SafeClaude** - Server-side enforcement + limited credentials + ephemeral
2. **Dev Containers** - Network firewall + agent forwarding + VS Code controls
3. **Sculptor** - Container isolation + UI oversight + branch workflow
4. **ClaudeBox** - Container isolation only + full SSH access

---

## Automation & Ease of Use

### Setup Time

| Step | SafeClaude | Sculptor | ClaudeBox | Dev Containers |
|------|-----------|----------|-----------|----------------|
| **Install Docker** | ‚úì | ‚úì | ‚úì | ‚úì |
| **Install VS Code** | ‚úó | ‚úó | ‚úó | ‚úì Required |
| **Install app/CLI** | CLI script | Desktop app | CLI script | 0 min (clone repo) |
| **Run installer** | 1 min | 1 min | 1 min | 0 min |
| **GitHub setup** | 5 min (manual) | 0 min | 0 min | 0 min |
| **Total first-time** | ~6 min | ~2 min | ~1 min | ~2 min |
| **Per-repo setup** | 2 min (deploy key) | 0 min | 0 min | 0 min |

### Automation Opportunities for Your Project

Based on ClaudeBox's approach, you could add:

1. **GitHub API automation:**
   ```bash
   # Auto-add deploy key
   gh api repos/$OWNER/$REPO/keys -f title="claudebox" \
     -f key="$(cat ~/.ssh/sandbox_deploy_key.pub)" -F read_only=false

   # Auto-enable branch protection
   gh api repos/$OWNER/$REPO/branches/main/protection -X PUT \
     -f required_pull_request_reviews='{"required_approving_review_count":1}'
   ```

2. **Self-extracting installer** (like `claudebox.run`)

3. **Interactive repo selector** - scan GitHub for your repos, choose one

4. **Profile system** - pre-configured setups for different languages

---

## Feature Comparison

| Feature | SafeClaude | Sculptor | ClaudeBox | Dev Containers |
|---------|-----------|----------|-----------|----------------|
| **Standalone** | ‚úÖ CLI | ‚úÖ Desktop app | ‚úÖ CLI | ‚ùå (VS Code) |
| **Parallel agents** | ‚ùå | ‚úÖ | ‚ùå | ‚ùå |
| **Multi-repo support** | ‚ùå (one at a time) | ‚úÖ | ‚úÖ | ‚úÖ |
| **Persistent state** | ‚ùå | ‚úÖ (per-agent) | ‚úÖ | ‚úÖ (volumes) |
| **Network isolation** | ‚úÖ (optional) | ‚ùå (required) | ‚ö†Ô∏è (firewall) | ‚ö†Ô∏è (firewall) |
| **Branch protection** | ‚úÖ (GitHub) | ‚ùå | ‚ùå | ‚ùå |
| **SSH key isolation** | ‚úÖ (deploy key) | ‚ùå (host keys) | ‚ùå (host keys) | ‚ùå (agent) |
| **Zero GitHub setup** | ‚ùå | ‚úÖ | ‚úÖ | ‚úÖ |
| **Ephemeral sessions** | ‚úÖ | ‚ö†Ô∏è (configurable) | ‚ùå | ‚ùå |
| **Visual UI** | ‚ùå | ‚úÖ | ‚ùå | ‚ö†Ô∏è (VS Code) |
| **Language profiles** | ‚ùå | ‚úÖ (custom) | ‚úÖ (15+) | ‚ö†Ô∏è (manual) |
| **Branch workflow** | Manual | ‚úÖ (built-in) | Manual | Manual |
| **Merge controls** | Manual | ‚úÖ (UI) | Manual | Manual |
| **Context management** | ‚ùå | ‚úÖ (compaction) | ‚ùå | ‚ùå |
| **Official support** | ‚ùå | ‚ö†Ô∏è (Imbue) | ‚ùå | ‚úÖ (Anthropic) |

---

## Recommendations

### Choose **SafeClaude** if:
- üéØ Security is paramount
- üéØ Working with untrusted/experimental code
- üéØ Need compliance/audit trail
- üéØ Want true isolation with server-side guarantees
- üéØ Prefer ephemeral, clean-slate sessions
- üéØ Need per-repo access control
- üéØ Running with `--dangerously-skip-permissions` in production

### Choose **Sculptor** if:
- üéØ Need to work on multiple features/bugs simultaneously
- üéØ Want visual oversight of parallel agents
- üéØ Prefer GUI over command-line tools
- üéØ Need structured branch-based workflow with UI controls
- üéØ Working on trusted codebases
- üéØ Want to maximize AI agent productivity through parallelism
- üéØ Need context management for long conversations

### Choose **ClaudeBox** if:
- üéØ Working on trusted projects
- üéØ Need persistent development environments
- üéØ Want multi-project workflows
- üéØ Require language-specific profiles (Python, Rust, Go, etc.)
- üéØ Prefer sophisticated state management
- üéØ Comfortable with full git access in container
- üéØ Power user who wants CLI control

### Choose **Dev Containers** if:
- üéØ Already using VS Code
- üéØ Want official Anthropic support
- üéØ Need standardized team environments
- üéØ Prefer integrated IDE experience
- üéØ Working with trusted repositories
- üéØ Want network firewall with allowlists

---

## Hybrid Approaches

You could combine the best features from multiple solutions:

### **SafeClaude + Sculptor Features**
```
‚úÖ Deploy key security (SafeClaude) + Parallel agents UI (Sculptor)
‚úÖ Server-side enforcement + Visual management
‚úÖ Zero trust model + Productivity through parallelism
```

### **SafeClaude + ClaudeBox Automation**
```
‚úÖ Deploy key security + Profile system
‚úÖ GitHub API automation + Language-specific environments
‚úÖ Branch protection + Persistent state (optional)
```

### **Ultimate Secure Workflow**
```bash
1. Deploy key (SafeClaude) - server-side security
2. GitHub API automation (ClaudeBox style) - ease of setup
3. Network firewall (Dev Containers) - defense in depth
4. Profile system (ClaudeBox) - language flexibility
5. Parallel agents (Sculptor) - productivity boost
6. UI oversight (Sculptor) - visual management
```

---

## The Branch Protection Gap

**Key Finding:** SafeClaude is the **only solution** that implements true branch protection through deploy keys and GitHub server-side enforcement.

All other solutions rely on:
- Container isolation only
- User discipline/oversight
- Post-hoc merge approval
- Trust in the codebase

While these are valid approaches for trusted environments, **none provide the guarantee that an AI agent cannot push to protected branches**, even with full container access.

---

## References

- **SafeClaude (This Project):** https://github.com/kaselby/safeclaude
- **Sculptor (Imbue):** https://github.com/imbue-ai/sculptor
  - Website: https://imbue.com/sculptor/
- **ClaudeBox (RchGrav):** https://github.com/RchGrav/claudebox
- **Claude Code Dev Containers:** https://docs.claude.com/en/docs/claude-code/devcontainer
  - Reference: https://github.com/anthropics/claude-code/tree/main/.devcontainer
